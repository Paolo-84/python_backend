<!DOCTYPE html>
<html>
<head>
    <title>Test Crypto WebSocket</title>
</head>
<body>
    <h1>Test Crypto API</h1>
    <div>Estado: <span id="status">Desconectado</span></div>
    <div>Última actualización: <span id="lastUpdate">-</span></div>
    <div id="data"></div>

    <script>
        const ws = new WebSocket('wss://python-backend-s0jf.onrender.com/ws');

        ws.onopen = function() {
            document.getElementById('status').textContent = 'Conectado ✅';
        };

        ws.onmessage = function(event) {
            const data = JSON.parse(event.data);
            document.getElementById('lastUpdate').textContent = data.market.lastUpdated;
            document.getElementById('data').innerHTML = 
                '<h3>Market Cap: ' + data.market.marketCap + '</h3>' +
                '<h3>Volume 24h: ' + data.market.volume24h + '</h3>' +
                '<h4>Top 5 Cryptos:</h4>' +
                '<ul>' + 
                data.assets.slice(0, 5).map(asset => 
                    '<li>' + asset.name + ' (' + asset.symbol + '): ' + asset.price + '</li>'
                ).join('') +
                '</ul>';
        };

        ws.onclose = function() {
            document.getElementById('status').textContent = 'Desconectado ❌';
        };

        ws.onerror = function(error) {
            document.getElementById('status').textContent = 'Error ❌';
            console.error('WebSocket error:', error);
        };
    </script>
</body>
</html>
